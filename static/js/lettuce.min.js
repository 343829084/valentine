/*! lettuce 21-01-2015 */
!function(a){"use strict";var b=function(){};b.VERSION="0.1.0",a.lettuce=b,b.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},b.isFunction=function(a){return"function"==typeof a||!1},b.defaults=function(a){if(!b.isObject(a))return a;for(var c=1,d=arguments.length;d>c;c++){var e=arguments[c];for(var f in e)void 0===a[f]&&(a[f]=e[f])}return a},b.extend=function(a){if(!b.isObject(a))return a;for(var c,d,e=1,f=arguments.length;f>e;e++){c=arguments[e];for(d in c)hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},b.prototype.Class=function(a,c){var d=function e(d,f){function g(){var a=this instanceof g?this:new h;return a.init.apply(a,arguments),a}function h(){}g.Basic=h;var i=h[a]=d[a],j=h[a]=g[a]=new h;j.constructor=g,g.extend=function(a){return new e(g,a)};var k=g.open=function(a){if(b.isFunction(a)&&(a=a.call(g,j,i,g,d)),b.isObject(a))for(var e in a)c.call(a,e)&&(j[e]=a[e]);return"init"in j||(j.init=d),g};return k(f)};return d}("prototype",{}.hasOwnProperty);var c=new b.prototype.Class({});c.prototype.init=function(a){this.options=a||{},b.defaults(this.options,{first:"first",regex:/.*Page/,last:"last"})},c.prototype.run=function(a){var b=this;b.methods=a,b.execute(b.options.first);for(var c in b.methods)c!==b.options.last&&c.match(b.options.regex)&&this.execute(c);b.execute(b.options.last)},c.prototype.execute=function(a){this.methods[a]()};var d={Parser:c};b.prototype=b.extend(b.prototype,d),b.get=function(a,c){b.send(a,"GET",c)},b.post=function(a,c,d){b.send(a,"POST",d,c)},b.send=function(a,b,c,d){d=d||null;var e=new XMLHttpRequest;c instanceof Function&&(e.onreadystatechange=function(){4!==e.readyState||200!==e.status&&0!==e.status||c(e.responseText)}),e.open(b,a,!0),d instanceof Object&&(d=JSON.stringify(d),e.setRequestHeader("Content-Type","application/json")),e.setRequestHeader("X-Requested-With","XMLHttpRequest"),e.send(d)};var e={on:function(a,b){this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)},off:function(a,b){this._events=this._events||{},a in this._events!=!1&&this._events[a].splice(this._events[a].indexOf(b),1)},trigger:function(a){if(this._events=this._events||{},a in this._events!=!1)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}},f={Event:e};b.prototype=b.extend(b.prototype,f);var g={regexp:/([\s'\\])(?!(?:[^{]|\{(?!%))*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,encReg:/[<>&"'\x00]/g,encMap:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},arg:"o",helper:",print=function(s,e){_s+=e?(s==null?'':s):_e(s);},include=function(s,d){_s+=tmpl(s,d);}",tmpl:function(a,b){var c=/[^\w\-\.:]/.test(a)?this.compile(a):"";return c(b,this)},compile:function(a){var b,c;return c=this.arg+",tmpl",b="var _e=tmpl.encode"+this.helper+",_s='"+a.replace(this.regexp,this.func)+"';",b+="return _s;",new Function(c,b)},encode:function(a){var b=/[<>&"'\x00]/g,c={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"};return(null==a?"":""+a).replace(b,function(a){return c[a]||""})},func:function(a,b,c,d,e,f){var g={"\n":"\\n","\r":"\\r","	":"\\t"," ":" "};return b?g[b]||"\\"+b:c?"="===c?"'+_e("+d+")+'":"'+("+d+"==null?'':"+d+")+'":e?"';":f?"_s+='":void 0}},h={Template:g};b.prototype=b.extend(b.prototype,h);var i=new b.prototype.Class({});i.prototype.init=function(){},i.prototype.render=function(a,b){document.getElementById(b).innerHTML=a};var j={SimpleView:i};b.prototype=b.extend(b.prototype,j);var k={routes:[],hashStrip:/^#*/,location:window.location,getFragment:function(){return this.location.hash.replace(this.hashStrip,"")},add:function(a,c){return b.isFunction(a)&&(c=a,a=""),this.routes.push({regex:a,handler:c}),this},check:function(a){for(var b=a.getFragment(),c=0;c<a.routes.length;c++){var d="#"+b,e=d.match(a.routes[c].regex);e&&(e.shift(),a.routes[c].handler.apply({},e))}},load:function(){function a(){window.addEventListener?window.addEventListener("hashchange",c,!1):window.attachEvent&&window.attachEvent("onhashchange",c)}var b,c;return b=this,c=function(){b.check(b)},a(),this},navigate:function(a){return a=a?a:"",this.location.href.match(/#(.*)$/),this.location.href=this.location.href.replace(/#(.*)$/,"")+"#"+a,this}},l={Router:k};b.prototype=b.extend(b.prototype,l)}(this);